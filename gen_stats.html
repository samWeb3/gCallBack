<html>
    <head><title></title>	
	<link href="layout.css" rel="stylesheet" type="text/css">	
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.min.js" type="text/javascript" charset="utf-8"></script>
	<script language="javascript" type="text/javascript" src="js/stat/jquery.flot.js"></script>
	<script language="javascript" type="text/javascript" src="js/stat/jquery.flot.symbol.js"></script>
	<script language="javascript" type="text/javascript" src="js/stat/jquery.flot.navigate.js"></script>
	
	<style type="text/css">
	#placeholder .button {
	    position: absolute;
	    cursor: pointer;
	}
	#placeholder div.button {
	    font-size: smaller;
	    color: #999;
	    background-color: #eee;
	    padding: 2px;
	}
	.message {
	    padding-left: 50px;
	    font-size: smaller;
	}
	</style>
    </head>
    <body>
	<h1>Call Back Statistics</h1>
	<div id="placeholder" style="width:818px; height:300px"></div>
	<p id="choices">Show:</p>

	<script>	    
	    var dayRange = new Array(6, 7, 8, 9, 10, 11, 12);
	    var callBackRec = new Array(66, 44, 12, 15, 60, 30, 22);
	    var answeredRec = new Array(44, 30, 10, 10, 55, 30, 21);
	    
	    /**
	     * Construct the multidimentional array based on the day and record passed!
	     * 
	     * @param int day	no of days retrieved from date range
	     * @param int rec   no of record for each day
	     */
	    function multiDimenArray(day, rec){
		var nOfR = day.length;
	   
		//this unit array holds day and record for e.g [6. 7]
		var unit = new Array();

		//data multidimentional array holds number of unit array for e.g., [[6, 7], [7, 44]]
		var data = new Array();

		for (i=0; i<nOfR; i++){ 
		    //add day and callback record into unit array
		    unit = new Array(day[i], rec[i]);
		    //add unit array into data mulit-dimen array
		    data.push(unit);		    
		}	       
		return data;
	    }
	    
	   	
	    //Following Script is for generating statistics
	    var callbackData = multiDimenArray(dayRange, callBackRec);
	    console.log("Returned CallBack Data: ", callbackData);
	    var answeredData = multiDimenArray(dayRange, answeredRec);	       
	    console.log("Returned CallBack Data: ", callbackData);
	    	    
	    var datasets = [ 
		{ 
		    color: "red", 
		    label: "CallBacks", 		    
		    data: callbackData
		}, 
		{ 
		    color: "green", 
		    label: "Answered", 		     
		    data: answeredData
		} 
	    ]; 
	    var options = {
		series: {
		    lines: { show: true },
		    points: { show: true }
		}			
	    };		
	    
	    var plot = $.plot($("#placeholder"), datasets, options);
	    
	    // hard-code color indices to prevent them from shifting as
	    // countries are turned on/off
	   /* var i = 0;
	    $.each(datasets, function(key, val) {
		val.color = i;
		++i;
	    });
*/
	    // insert checkboxes 
	    var choiceContainer = $("#choices");
	    $.each(datasets, function(key, val) {
		choiceContainer.append('<br/><input type="checkbox" name="' + key +
				       '" checked="checked" id="id' + key + '">' +
				       '<label for="id' + key + '">'
					+ val.label + '</label>');
	    });
	    choiceContainer.find("input").click(plotAccordingToChoices);


	    function plotAccordingToChoices() {
		console.log("hi");
		var data = [];

		choiceContainer.find("input:checked").each(function () {
		    var key = $(this).attr("name");
		    if (key && datasets[key])
			data.push(datasets[key]);
		});

		if (data.length > 0)
		    $.plot($("#placeholder"), data, {
			yaxis: { min: 0 },
			xaxis: { tickDecimals: 0 }
		    });
	    }

	    plotAccordingToChoices();
	</script>
    </body>
</html>